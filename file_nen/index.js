$(function(){$(".btn-add-cart").click(function(){let t=$(this).attr("data-link"),e=$(this).attr("data-name"),o=$(this).attr("data-id"),n=$(this).attr("data-img");return $.ajax({type:"post",dataType:"json",url:URL_AJAX,data:{action:"saveSessionItem",link:t,name:e,id:o,img:n},context:this,beforeSend:function(){},success:function(t){t.success?($(".alert-cart").show(),$(".number-cart").html(t.data),$("html,body").animate({scrollTop:$(".head-info").offset().top},"slow")):alert("Đã có lỗi xảy ra")},error:function(t,e,o){console.log("The following error occured: "+e,o)}}),!1}),$(".i-close").click(function(t){$(".alert-cart").hide()});var t=document.getElementById("navFixed"),e=t.offsetTop,o=$(".page-footer").height();$(window).height();function n(t,e,o){$.ajax({type:"post",dataType:"json",url:URL_AJAX,data:{action:"updateProduct",id:t,number_delete:e,type:o},context:this,beforeSend:function(){},success:function(e){if(e.success){if(e.data.data){let n=e.data.data,a=n.count,c=n.number_item;switch(o){case"delete":$("#"+t).hide();break;case"addstract":case"substract":default:$("#"+t+" .number-item").val(c)}$(".number-sp").text(a),$(".number-cart ").text(a),0==a&&$(".right-cart").html("")}}else alert("Đã có lỗi xảy ra")},error:function(t,e,o){console.log("The following error occured: "+e,o)}})}window.onscroll=function(o){window.innerHeight+window.scrollY>=document.body.offsetHeight-241?$(".section-payment").addClass("section-tmp-payment"):$(".section-payment").removeClass("section-tmp-payment"),window.pageYOffset>e?t.classList.add("sticky"):t.classList.remove("sticky")},$(".delete-item").click(function(){if(1==confirm("Bạn có chắc chắn muốn xóa sản phẩm này?")){n($(this).attr("data-id"),0,"delete")}}),$(".item-subtract").click(function(){let t=$(this).attr("data-id"),e=$("#"+t+" .number-item").val();1!=e&&e>1?(e--,$("#"+t+" .number-item").val(e),n(t,1,"substract")):alert("Vui lòng chọn số lượng lớn hơn 1!")}),$(".item-addtract").click(function(){let t=$(this).attr("data-id"),e=$("#"+t+" .number-item").val();e<99999?(e++,$("#"+t+" .number-item").val(e),n(t,1,"addstract")):alert("Số lượng vượt mức cho phép!")}),$(".number-item").focusout(function(){let t=$(this).attr("data-id"),e=$(this).val();e>0?n(t,e,"edit"):alert("Số lượng nhập vào không hợp lệ!")}),$('select[name="provice"]').change(function(){let t=$(this).val();$.ajax({type:"post",dataType:"json",url:URL_AJAX,data:{action:"getTown",name_provice:t},context:this,beforeSend:function(){},success:function(t){if(t.success){if(console.log(t.data),t.data){let e=t.data,o="";$('select[name="town"]').html(""),o+='<option value="">---Quận/huyện---</option>',e.forEach(function(t,e){o+='<option value="'+t+'">'+t+"</option>"}),$('select[name="town"]').html(o)}}else alert("Đã có lỗi xảy ra")},error:function(t,e,o){console.log("The following error occured: "+e,o)}})}),$(".btn-checkout").click(function(){let t=[];t.provice=$('#form-checkout select[name="provice"]').val(),t.town=$('#form-checkout select[name="town"]').val(),t.email=$('#form-checkout input[name="email"]').val(),t.customer=$('#form-checkout input[name="customer"]').val(),t.address=$('#form-checkout textarea[name="address"]').val(),t.remask=$('#form-checkout textarea[name="remask"]').val();let e=function(t){let e=[];""==t.email&&e.push("Vui lòng nhập email or số điện thoại!");""==t.address&&e.push("Vui lòng nhập địa chỉ giao hàng!");""==t.customer&&e.push("Vui lòng nhập tên khách hàng!");""==t.provice&&e.push("Vui lòng chọn Tỉnh!");""==t.town&&e.push("Vui lòng chọn quận huyện!");return e}(t);0==e.length?($(".box-err").hide(),function(t){$.ajax({type:"post",dataType:"json",url:URL_AJAX,data:{action:"saveOrder",email:t.email,customer:t.customer,provice:t.provice,town:t.town,address:t.address,remask:t.remask},context:this,beforeSend:function(){},success:function(t){t.success?window.location.href=URL_ROOT+"/confirm-cart":alert("Đã có lỗi xảy ra")},error:function(t,e,o){console.log("The following error occured: "+e,o)}})}(t)):($(".box-err").show(),function(t){let e="";t&&(e+="<ul>",t.forEach(function(t){e+="<li>",e+=t,e+="</li>"}),e+="</ul>");$("html,body").animate({scrollTop:$("#form-checkout").offset().top},"slow"),$(".box-err").html(e)}(e))}),$("#btn-order").click(function(t){$(this).attr("disabled","disabled"),$.ajax({type:"post",dataType:"json",url:URL_AJAX,data:{action:"sendOrder"},context:this,beforeSend:function(){},success:function(t){$("#btn-order").removeAttr("disabled"),t.success?window.location.href=URL_ROOT+"/order-success":alert("Đã có lỗi xảy ra")},error:function(t,e,o){console.log("The following error occured: "+e,o)}})})});